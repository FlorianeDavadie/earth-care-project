<div class="container">
  <div class="margin">
    <div class="card-main radius h-25 mt-5">
      <div class="mt-3">
        <div class="color-font text-center">
          <span><i class="fas fa-calendar-alt"></i> <%= @mission.start_date %> - </span>
          <span><%= @mission.end_date %></span>
          <span><i class="far fa-clock"></i> <%= Time.new(2000, 1, 1, rand(5..21), [0, 15, 30, 45].sample).strftime('%H:%M') %> <strong>sharp</strong><%="ðŸ‘Œ".html_safe%></span>
        </div>
      </div>
      <div class="color-font text-center pb-2">
        <span><i class="fas fa-star"></i>  <%= @mission.rating %> Stars</span>
        <span><i class="fas fa-trophy"></i>  <%= @mission.reward %> Points</span>
      </div>

      <% if @mission.photo_url %>
        <div class="image-wrapper">
          <%= image_tag @mission.photo_url, height: 150, class: "w-100 object-fit-cover", class: "card-img-top" %>
        </div>
      <% end %>
      <div class="card-main-details">
        <div class="overflow-text">
          <h2 class="text-center mb-3"><%= @mission.title %></h2>
          <div class="d-flex">
            <span class=" color-font w-10 mb-3"><%= @mission.address %></span>
            <span class="color-font w-10 mb-3"><%=  @mission.location %></span>
          </div>
          <p class="text-center width overflow-scroll"> <%= @mission.description %></p>
          <div class="text-center">
            <div class="d-flex justify-content-around">

              <% if current_user != @mission.user %>
                <% if @booking.persisted? %>
                  <strong> to Unlocked your  <%= @booking.mission.reward %> points for this mission click on the button below </strong>
                  <br>
                  <%= simple_form_for([@booking, @voucher]) do |f| %>
                    <%= f.text_area :total_points, style: 'display:none' %>
                    <strong>ðŸ‘‰<%= f.submit "I completed my mission ", class: "btn btn-success"%> ðŸ‘ˆ </strong>
                  <% end %>
                  <%# si id de booking exist %>
                <% else %>
                  <%= simple_form_for [@mission, @booking] do |f| %>
                    <%= f.submit "Accept", class: "btn btn-success" %>
                  <% end %>
                  <%= simple_form_for [@mission, @declined_booking] do |f| %>
                    <%= f.submit "Decline", class: "btn btn-warning" %>
                  <% end %>
                <% end %>
              <% end %>

            </div>

            <div class="text-center mt-2">
              <div style="width: 100%; height: 200px;"
                data-controller="map"
                data-map-markers-value="<%= @mission_marker.to_json %>"
                data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
              </div>
            </div>
          </div>
        </div>




        <p>
          <% if current_user == @mission.user %>
            <%= link_to "Edit you posted mission", edit_mission_path(@mission.id),class: "btn"  %>
            <%= link_to "Delete your mission", mission_path(@mission), method: :delete, data: { confirm: "Are you sure?" } %>
            <%# <%= link_to "Dashboard", profil_path, data: {turbo_method: :get}, class: "btn" %>
          <% end %>
        </p>
      </div>
    </div>
  </div>
</div>
